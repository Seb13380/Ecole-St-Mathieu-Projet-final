{% extends "layout.twig" %}

{% block title %}üìö Documents - {{ categoryName ?? '√âcole' }}{% endblock %}

{% block body %}

<div class="container mx-auto px-4 py-6">

    {# Header avec titre et breadcrumb #}
    <div class="mb-8">
        <div class="flex items-center text-sm text-slate-500 mb-4">
            <a href="/" class="hover:text-[#304a4d] transition-colors">üè† Accueil</a>
            <span class="mx-2">‚Üí</span>
            <span>üìö Documents</span>
        </div>

        <div class="text-center">
            <h1 class="text-4xl font-bold text-[#304a4d] mb-4">
                üìö Documents de l'√âcole
            </h1>
            <p class="text-lg text-slate-600 max-w-2xl mx-auto">
                Consultez nos documents officiels et ressources p√©dagogiques
            </p>
        </div>
    </div>

    {# Grille des cartes de documents #}
    <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">

        {# Carte du projet √©ducatif et d'√©tablissement - TOUJOURS EN PREMIER #}
        {% if documentsByType['PROJET_EDUCATIF'] or documentsByType['PROJET_ETABLISSEMENT'] %}
            <div class="card bg-base-100 shadow-lg hover:shadow-xl transition-shadow duration-300 border-l-4 border-blue-500">
                <div class="card-body">
                    <div class="flex items-start justify-between mb-3">
                        <h3 class="card-title text-[#304a4d] text-lg">
                            üéØ Projet √©ducatif & d'√©tablissement
                        </h3>
                        <div class="badge badge-info badge-sm">üåç Acc√®s public</div>
                    </div>

                    <p class="text-slate-600 text-sm mb-4 leading-relaxed">
                        Notre vision p√©dagogique et nos orientations √©ducatives
                    </p>

                    <div class="space-y-2 mb-4">
                        {% if documentsByType['PROJET_EDUCATIF'] %}
                            {% for doc in documentsByType['PROJET_EDUCATIF'] %}
                                <div class="flex items-center justify-between p-2 bg-slate-50 rounded">
                                    <span class="text-sm font-medium">üéØ {{ doc.titre }}</span>
                                    <div class="flex gap-1">
                                        {% if doc.contenu %}
                                            <a href="/documents/show/{{ doc.id }}" class="btn btn-xs btn-primary">
                                                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                                </svg>
                                            </a>
                                        {% endif %}
                                        {% if doc.isExternalLink and doc.externalUrl %}
                                            <a href="{{ doc.externalUrl }}" target="_blank" class="btn btn-xs btn-accent">üîó</a>
                                        {% elseif doc.pdfUrl %}
                                            <a href="{{ doc.pdfUrl }}" target="_blank" class="btn btn-xs btn-secondary">üìÑ</a>
                                        {% endif %}
                                    </div>
                                </div>
                            {% endfor %}
                        {% endif %}

                        {% if documentsByType['PROJET_ETABLISSEMENT'] %}
                            {% for doc in documentsByType['PROJET_ETABLISSEMENT'] %}
                                <div class="flex items-center justify-between p-2 bg-slate-50 rounded">
                                    <span class="text-sm font-medium">üè´ {{ doc.titre }}</span>
                                    <div class="flex gap-1">
                                        {% if doc.contenu %}
                                            <a href="/documents/show/{{ doc.id }}" class="btn btn-xs btn-primary">
                                                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                                </svg>
                                            </a>
                                        {% endif %}
                                        {% if doc.isExternalLink and doc.externalUrl %}
                                            <a href="{{ doc.externalUrl }}" target="_blank" class="btn btn-xs btn-accent">üîó</a>
                                        {% elseif doc.pdfUrl %}
                                            <a href="{{ doc.pdfUrl }}" target="_blank" class="btn btn-xs btn-secondary">üìÑ</a>
                                        {% endif %}
                                    </div>
                                </div>
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
            </div>
        {% endif %}

        {# Carte R√®glement int√©rieur #}
        {% if documentsByType['REGLEMENT_INTERIEUR'] %}
            <div class="card bg-base-100 shadow-lg hover:shadow-xl transition-shadow duration-300 border-l-4 border-green-500">
                <div class="card-body">
                    <div class="flex items-start justify-between mb-3">
                        <h3 class="card-title text-[#304a4d] text-lg">
                            üìú R√®glement int√©rieur
                        </h3>
                        <div class="badge badge-success badge-sm">üåç Acc√®s public</div>
                    </div>

                    <p class="text-slate-600 text-sm mb-4 leading-relaxed">
                        R√®gles de vie et organisation de l'√©cole
                    </p>

                    <div class="space-y-2 mb-4">
                        {% for doc in documentsByType['REGLEMENT_INTERIEUR'] %}
                            <div class="flex items-center justify-between p-2 bg-slate-50 rounded">
                                <span class="text-sm font-medium">üìú {{ doc.titre }}</span>
                                <div class="flex gap-1">
                                    {% if doc.contenu %}
                                        <a href="/documents/show/{{ doc.id }}" class="btn btn-xs btn-primary">
                                            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 616 0z"></path>
                                            </svg>
                                        </a>
                                    {% endif %}
                                    {% if doc.isExternalLink and doc.externalUrl %}
                                        <a href="{{ doc.externalUrl }}" target="_blank" class="btn btn-xs btn-accent">üîó</a>
                                    {% elseif doc.pdfUrl %}
                                        <a href="{{ doc.pdfUrl }}" target="_blank" class="btn btn-xs btn-secondary">üìÑ</a>
                                    {% endif %}
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        {% endif %}

        {# Carte Dossier d'inscription #}
        {% if documentsByType['DOSSIER_INSCRIPTION'] %}
            <div class="card bg-base-100 shadow-lg hover:shadow-xl transition-shadow duration-300 border-l-4 border-green-500">
                <div class="card-body">
                    <div class="flex items-start justify-between mb-3">
                        <h3 class="card-title text-[#304a4d] text-lg">
                            üìã Dossier d'inscription
                        </h3>
                        <div class="badge badge-success badge-sm">üåç Acc√®s public</div>
                    </div>

                    <p class="text-slate-600 text-sm mb-4 leading-relaxed">
                        Documents n√©cessaires pour l'inscription des √©l√®ves
                    </p>

                    <div class="space-y-2 mb-4">
                        {% for doc in documentsByType['DOSSIER_INSCRIPTION'] %}
                            <div class="flex items-center justify-between p-2 bg-slate-50 rounded">
                                <span class="text-sm font-medium">üìã {{ doc.titre }}</span>
                                <div class="flex gap-1">
                                    {% if doc.contenu %}
                                        <a href="/documents/show/{{ doc.id }}" class="btn btn-xs btn-primary">
                                            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 616 0z"></path>
                                            </svg>
                                        </a>
                                    {% endif %}
                                    {% if doc.isExternalLink and doc.externalUrl %}
                                        <a href="{{ doc.externalUrl }}" target="_blank" class="btn btn-xs btn-accent">üîó</a>
                                    {% elseif doc.pdfUrl %}
                                        <a href="{{ doc.pdfUrl }}" target="_blank" class="btn btn-xs btn-secondary">üìÑ</a>
                                    {% endif %}
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        {% endif %}

        {# Carte Chartes (acc√®s restreint) #}
        {% if documentsByType['CHARTE_LAICITE'] or documentsByType['CHARTE_NUMERIQUE'] or documentsByType['CHARTE_VIE_SCOLAIRE'] or documentsByType['CHARTE_RESTAURATION'] %}
            {% if isAuthenticated %}
                <div class="card bg-base-100 shadow-lg hover:shadow-xl transition-shadow duration-300 border-l-4 border-orange-500">
                    <div class="card-body">
                        <div class="flex items-start justify-between mb-3">
                            <h3 class="card-title text-[#304a4d] text-lg">
                                ‚öñÔ∏è Chartes
                            </h3>
                            <div class="badge badge-warning badge-sm">üîí Acc√®s restreint</div>
                        </div>

                        <p class="text-slate-600 text-sm mb-4 leading-relaxed">
                            Chartes et r√®glements de l'√©cole
                        </p>

                        <div class="space-y-2 mb-4">
                            {% if documentsByType['CHARTE_LAICITE'] %}
                                {% for doc in documentsByType['CHARTE_LAICITE'] %}
                                    <div class="flex items-center justify-between p-2 bg-slate-50 rounded">
                                        <span class="text-sm font-medium">‚öñÔ∏è {{ doc.titre }}</span>
                                        <div class="flex gap-1">
                                            {% if doc.contenu %}
                                                <a href="/documents/show/{{ doc.id }}" class="btn btn-xs btn-primary">
                                                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 616 0z"></path>
                                                    </svg>
                                                </a>
                                            {% endif %}
                                            {% if doc.isExternalLink and doc.externalUrl %}
                                                <a href="{{ doc.externalUrl }}" target="_blank" class="btn btn-xs btn-accent">üîó</a>
                                            {% elseif doc.pdfUrl %}
                                                <a href="{{ doc.pdfUrl }}" target="_blank" class="btn btn-xs btn-secondary">üìÑ</a>
                                            {% endif %}
                                        </div>
                                    </div>
                                {% endfor %}
                            {% endif %}

                            {% if documentsByType['CHARTE_NUMERIQUE'] %}
                                {% for doc in documentsByType['CHARTE_NUMERIQUE'] %}
                                    <div class="flex items-center justify-between p-2 bg-slate-50 rounded">
                                        <span class="text-sm font-medium">üíª {{ doc.titre }}</span>
                                        <div class="flex gap-1">
                                            {% if doc.contenu %}
                                                <a href="/documents/show/{{ doc.id }}" class="btn btn-xs btn-primary">
                                                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 616 0z"></path>
                                                    </svg>
                                                </a>
                                            {% endif %}
                                            {% if doc.isExternalLink and doc.externalUrl %}
                                                <a href="{{ doc.externalUrl }}" target="_blank" class="btn btn-xs btn-accent">üîó</a>
                                            {% elseif doc.pdfUrl %}
                                                <a href="{{ doc.pdfUrl }}" target="_blank" class="btn btn-xs btn-secondary">üìÑ</a>
                                            {% endif %}
                                        </div>
                                    </div>
                                {% endfor %}
                            {% endif %}

                            {% if documentsByType['CHARTE_VIE_SCOLAIRE'] %}
                                {% for doc in documentsByType['CHARTE_VIE_SCOLAIRE'] %}
                                    <div class="flex items-center justify-between p-2 bg-slate-50 rounded">
                                        <span class="text-sm font-medium">üéì {{ doc.titre }}</span>
                                        <div class="flex gap-1">
                                            {% if doc.contenu %}
                                                <a href="/documents/show/{{ doc.id }}" class="btn btn-xs btn-primary">
                                                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 616 0z"></path>
                                                    </svg>
                                                </a>
                                            {% endif %}
                                            {% if doc.isExternalLink and doc.externalUrl %}
                                                <a href="{{ doc.externalUrl }}" target="_blank" class="btn btn-xs btn-accent">üîó</a>
                                            {% elseif doc.pdfUrl %}
                                                <a href="{{ doc.pdfUrl }}" target="_blank" class="btn btn-xs btn-secondary">üìÑ</a>
                                            {% endif %}
                                        </div>
                                    </div>
                                {% endfor %}
                            {% endif %}

                            {% if documentsByType['CHARTE_RESTAURATION'] %}
                                {% for doc in documentsByType['CHARTE_RESTAURATION'] %}
                                    <div class="flex items-center justify-between p-2 bg-slate-50 rounded">
                                        <span class="text-sm font-medium">üçΩÔ∏è {{ doc.titre }}</span>
                                        <div class="flex gap-1">
                                            {% if doc.contenu %}
                                                <a href="/documents/show/{{ doc.id }}" class="btn btn-xs btn-primary">
                                                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 616 0z"></path>
                                                    </svg>
                                                </a>
                                            {% endif %}
                                            {% if doc.isExternalLink and doc.externalUrl %}
                                                <a href="{{ doc.externalUrl }}" target="_blank" class="btn btn-xs btn-accent">üîó</a>
                                            {% elseif doc.pdfUrl %}
                                                <a href="{{ doc.pdfUrl }}" target="_blank" class="btn btn-xs btn-secondary">üìÑ</a>
                                            {% endif %}
                                        </div>
                                    </div>
                                {% endfor %}
                            {% endif %}
                        </div>
                    </div>
                </div>
            {% else %}
                {# Affichage pour les visiteurs non connect√©s #}
                <div class="card bg-slate-100 shadow-lg border-l-4 border-slate-400">
                    <div class="card-body">
                        <div class="flex items-start justify-between mb-3">
                            <h3 class="card-title text-slate-500 text-lg">‚öñÔ∏è Chartes</h3>
                            <div class="badge badge-warning badge-sm">üîí Connexion requise</div>
                        </div>
                        <p class="text-slate-500 text-sm mb-4">
                            Ces documents sont r√©serv√©s aux membres de la communaut√© √©ducative.
                        </p>
                        <div class="card-actions justify-center">
                            <a href="/auth/login" class="btn btn-outline btn-sm">
                                üîê Se connecter pour acc√©der
                            </a>
                        </div>
                    </div>
                </div>
            {% endif %}
        {% endif %}

        {# Carte Organigramme (acc√®s restreint) #}
        {% if documentsByType['ORGANIGRAMME'] %}
            {% if isAuthenticated %}
                <div class="card bg-base-100 shadow-lg hover:shadow-xl transition-shadow duration-300 border-l-4 border-orange-500">
                    <div class="card-body">
                        <div class="flex items-start justify-between mb-3">
                            <h3 class="card-title text-[#304a4d] text-lg">
                                üèóÔ∏è Organigramme
                            </h3>
                            <div class="badge badge-warning badge-sm">üîí Acc√®s restreint</div>
                        </div>

                        <p class="text-slate-600 text-sm mb-4 leading-relaxed">
                            Organisation et structure de l'√©quipe √©ducative
                        </p>

                        <div class="space-y-2 mb-4">
                            {% for doc in documentsByType['ORGANIGRAMME'] %}
                                <div class="flex items-center justify-between p-2 bg-slate-50 rounded">
                                    <span class="text-sm font-medium">üèóÔ∏è {{ doc.titre }}</span>
                                    <div class="flex gap-1">
                                        {% if doc.contenu %}
                                            <a href="/documents/show/{{ doc.id }}" class="btn btn-xs btn-primary">
                                                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 616 0z"></path>
                                                </svg>
                                            </a>
                                        {% endif %}
                                        {% if doc.isExternalLink and doc.externalUrl %}
                                            <a href="{{ doc.externalUrl }}" target="_blank" class="btn btn-xs btn-accent">üîó</a>
                                        {% elseif doc.pdfUrl %}
                                            <a href="{{ doc.pdfUrl }}" target="_blank" class="btn btn-xs btn-secondary">üìÑ</a>
                                        {% endif %}
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            {% else %}
                {# Affichage pour les visiteurs non connect√©s #}
                <div class="card bg-slate-100 shadow-lg border-l-4 border-slate-400">
                    <div class="card-body">
                        <div class="flex items-start justify-between mb-3">
                            <h3 class="card-title text-slate-500 text-lg">üèóÔ∏è Organigramme</h3>
                            <div class="badge badge-warning badge-sm">üîí Connexion requise</div>
                        </div>
                        <p class="text-slate-500 text-sm mb-4">
                            Ce document est r√©serv√© aux membres de la communaut√© √©ducative.
                        </p>
                        <div class="card-actions justify-center">
                            <a href="/auth/login" class="btn btn-outline btn-sm">
                                üîê Se connecter pour acc√©der
                            </a>
                        </div>
                    </div>
                </div>
            {% endif %}
        {% endif %}

        {# Carte Pastorale - Documents group√©s par type #}
        {% if documentsByType['PASTORALE_AXE'] or documentsByType['PASTORALE_INTENTIONS'] or documentsByType['PASTORALE_PROJET'] %}
            <div class="card bg-base-100 shadow-lg hover:shadow-xl transition-shadow duration-300 border-l-4 border-purple-500">
                <div class="card-body">
                    <div class="flex items-start justify-between mb-3">
                        <h3 class="card-title text-[#304a4d] text-lg">
                            ‚úùÔ∏è Pastorale
                        </h3>
                        <div class="badge badge-info badge-sm">üåç Acc√®s public</div>
                    </div>

                    <p class="text-slate-600 text-sm mb-4 leading-relaxed">
                        Orientation et projets pastoraux de l'√©cole
                    </p>

                    <div class="space-y-2 mb-4">
                        {% if documentsByType['PASTORALE_AXE'] %}
                            {% for doc in documentsByType['PASTORALE_AXE'] %}
                                <div class="flex items-center justify-between p-2 bg-slate-50 rounded">
                                    <span class="text-sm font-medium">‚úùÔ∏è {{ doc.titre }}</span>
                                    <div class="flex gap-1">
                                        {% if doc.contenu %}
                                            <a href="/documents/show/{{ doc.id }}" class="btn btn-xs btn-primary">
                                                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 616 0z"></path>
                                                </svg>
                                            </a>
                                        {% endif %}
                                        {% if doc.isExternalLink and doc.externalUrl %}
                                            <a href="{{ doc.externalUrl }}" target="_blank" class="btn btn-xs btn-accent">üîó</a>
                                        {% elseif doc.pdfUrl %}
                                            <a href="{{ doc.pdfUrl }}" target="_blank" class="btn btn-xs btn-secondary">üìÑ</a>
                                        {% endif %}
                                    </div>
                                </div>
                            {% endfor %}
                        {% endif %}

                        {% if documentsByType['PASTORALE_INTENTIONS'] %}
                            {% for doc in documentsByType['PASTORALE_INTENTIONS'] %}
                                <div class="flex items-center justify-between p-2 bg-slate-50 rounded">
                                    <span class="text-sm font-medium">üôè {{ doc.titre }}</span>
                                    <div class="flex gap-1">
                                        {% if doc.contenu %}
                                            <a href="/documents/show/{{ doc.id }}" class="btn btn-xs btn-primary">
                                                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 616 0z"></path>
                                                </svg>
                                            </a>
                                        {% endif %}
                                        {% if doc.isExternalLink and doc.externalUrl %}
                                            <a href="{{ doc.externalUrl }}" target="_blank" class="btn btn-xs btn-accent">üîó</a>
                                        {% elseif doc.pdfUrl %}
                                            <a href="{{ doc.pdfUrl }}" target="_blank" class="btn btn-xs btn-secondary">üìÑ</a>
                                        {% endif %}
                                    </div>
                                </div>
                            {% endfor %}
                        {% endif %}

                        {% if documentsByType['PASTORALE_PROJET'] %}
                            {% for doc in documentsByType['PASTORALE_PROJET'] %}
                                <div class="flex items-center justify-between p-2 bg-slate-50 rounded">
                                    <span class="text-sm font-medium">üìñ {{ doc.titre }}</span>
                                    <div class="flex gap-1">
                                        {% if doc.contenu %}
                                            <a href="/documents/show/{{ doc.id }}" class="btn btn-xs btn-primary">
                                                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 616 0z"></path>
                                                </svg>
                                            </a>
                                        {% endif %}
                                        {% if doc.isExternalLink and doc.externalUrl %}
                                            <a href="{{ doc.externalUrl }}" target="_blank" class="btn btn-xs btn-accent">üîó</a>
                                        {% elseif doc.pdfUrl %}
                                            <a href="{{ doc.pdfUrl }}" target="_blank" class="btn btn-xs btn-secondary">üìÑ</a>
                                        {% endif %}
                                    </div>
                                </div>
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
            </div>
        {% endif %}

    </div>

    {# Section des liens utiles ou informations compl√©mentaires #}
    <div class="mt-12 text-center">
        <div class="bg-slate-50 rounded-lg p-6">
            <h2 class="text-xl font-semibold text-[#304a4d] mb-3">
                üìû Besoin d'aide ?
            </h2>
            <p class="text-slate-600 mb-4">
                Pour toute question concernant nos documents ou pour obtenir des informations compl√©mentaires
            </p>
            <div class="flex justify-center gap-4 flex-wrap">
                <a href="/contact" class="btn btn-outline btn-sm">
                    üìß Nous contacter
                </a>
                <a href="tel:+33134567890" class="btn btn-outline btn-sm">
                    üìû 01 34 56 78 90
                </a>
            </div>
        </div>
    </div>

</div>

{% endblock %}
