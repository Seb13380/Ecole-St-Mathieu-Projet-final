{% extends "layouts/main.twig" %}

{% block content %}
	<style>
		@keyframes fade-in {
			from {
				opacity: 0;
				transform: translateY(20px);
			}
			to {
				opacity: 1;
				transform: translateY(0);
			}
		}

		@keyframes fade-in-up {
			from {
				opacity: 0;
				transform: translateY(40px);
			}
			to {
				opacity: 1;
				transform: translateY(0);
			}
		}

		@keyframes slide-up {
			from {
				opacity: 0;
				transform: translateY(60px);
			}
			to {
				opacity: 1;
				transform: translateY(0);
			}
		}

		@keyframes slide-down {
			from {
				opacity: 0;
				transform: translateY(-30px);
			}
			to {
				opacity: 1;
				transform: translateY(0);
			}
		}

		.animate-fade-in {
			animation: fade-in 0.8s ease-out;
		}

		.animate-fade-in-up {
			animation: fade-in-up 1s ease-out;
		}

		.animate-slide-up {
			animation: slide-up 0.9s ease-out;
		}

		.animate-slide-down {
			animation: slide-down 0.6s ease-out;
		}

		.hover\:shadow-3xl:hover {
			box-shadow: 0 35px 60px -12px rgba(0, 0, 0, 0.25);
		}

		.group:hover .group-hover\:animate-bounce {
			animation: bounce 1s infinite;
		}

		.group:hover .group-hover\:animate-pulse {
			animation: pulse 2s infinite;
		}

		/* Effet glassmorphism */
		.backdrop-blur-md {
			backdrop-filter: blur(12px);
		}

		/* Transition douce pour les inputs */
		.form-control input:focus,
		.form-control textarea:focus,
		.form-control select:focus {
			transform: translateY(-2px);
			box-shadow: 0 10px 25px -5px rgba(48, 74, 77, 0.25);
		}

		/* Animation pour les boutons */
		.btn {
			transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
		}

		.btn:hover {
			transform: translateY(-2px);
		}
	</style>

	<div
		class="min-h-screen bg-gradient-to-br from-[#a7e3dd] via-[#8dd3cc] to-[#7bc4bd] py-12 relative overflow-hidden">
		<!-- √âl√©ments d√©coratifs anim√©s -->
		<div class="absolute top-20 left-10 w-20 h-20 bg-white/10 rounded-full animate-bounce" style="animation-delay: 0s;"></div>
		<div class="absolute top-40 right-20 w-16 h-16 bg-white/20 rounded-full animate-pulse" style="animation-delay: 1s;"></div>
		<div class="absolute bottom-20 left-20 w-12 h-12 bg-white/15 rounded-full animate-bounce" style="animation-delay: 2s;"></div>
		<div class="absolute bottom-40 right-10 w-14 h-14 bg-white/10 rounded-full animate-pulse" style="animation-delay: 0.5s;"></div>

		<div class="container mx-auto px-4 relative z-10">
			<div
				class="max-w-4xl mx-auto">
				<!-- En-t√™te -->
				<div class="text-center mb-8 animate-fade-in">
					<div class="bg-white/20 backdrop-blur-md rounded-3xl p-8 shadow-2xl border border-white/30">
						<div class="mb-6">
							<div class="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-[#304a4d] to-[#2a3f42] rounded-2xl shadow-lg mb-4 transform hover:scale-110 transition-transform duration-300">
								<span class="text-3xl">üìã</span>
							</div>
						</div>
						<h1 class="text-5xl font-bold text-[#304a4d] mb-4 drop-shadow-lg">
							Demande de Pr√©-inscription √âl√®ve(s)
						</h1>

						<div class="flex justify-center mt-4">
							<div class="w-24 h-1 bg-gradient-to-r from-[#304a4d] to-[#8dd3cc] rounded-full"></div>
						</div>
					</div>
				</div>

				{# <!-- Annonce Petite Section 2026 -->
																				{% if config and config.afficherAnnoncePS2026 %}
																					<div id="annoncePS2026" class="mb-8">
																						<div
																							class="bg-gradient-to-r from-yellow-50 to-orange-50 border-2 border-yellow-300 rounded-xl shadow-lg p-6 relative overflow-hidden">
																							<!-- Ic√¥ne d√©corative -->
																							<div class="absolute top-2 right-2 text-yellow-300 text-6xl opacity-20">
																								üéì
																							</div>
																
																							<div class="relative z-10">
																								<div class="flex items-center mb-4">
																									<span class="text-3xl mr-3">üåü</span>
																									<h2 class="text-2xl font-bold text-orange-700">
																										Inscription Petite Section - Rentr√©e 2026
																									</h2>
																								</div>
																
																								<div class="bg-white/70 backdrop-blur-sm rounded-lg p-4 mb-4">
																									<p class="text-lg text-orange-800 mb-3 font-medium">
																										üìÖ Pour toute demande d'inscription en Petite Section pour la rentr√©e 2026
																									</p>
																									<p class="text-orange-700 mb-4">
																										Veuillez utiliser le formulaire officiel Microsoft Forms d√©di√© :
																									</p>
																
																									<div class="text-center">
																										<a href="https://forms.office.com/e/tm7H3nJbbH" target="_blank" rel="noopener" class="inline-flex items-center bg-orange-600 hover:bg-orange-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-all duration-200 hover:shadow-xl transform hover:scale-105">
																											<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24">
																												<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-2M7 13l3 3 7-7"></path>
																											</svg>
																											Acc√©der au formulaire d'inscription PS 2026
																										</a>
																									</div>
																								</div>
																
																								<div class="text-center">
																									<p class="text-sm text-orange-600 italic">
																										‚è∞ Ce formulaire est sp√©cialement con√ßu pour les futures petites sections
																									</p>
																								</div>
																							</div>
																						</div>
																					</div>
																				{% endif %} #}

				<!-- Documents √† t√©l√©charger -->
				{% if inscriptionDocuments and inscriptionDocuments|length > 0 %}
					<div id="documentsSection" class="mb-8 animate-slide-up">
						<div class="bg-white/95 backdrop-blur-md rounded-2xl shadow-2xl p-8 border border-white/50 hover:shadow-3xl transition-all duration-300">
							<div class="flex items-center mb-6">
								<div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center mr-4 shadow-lg">
									<span class="text-2xl">üìÅ</span>
								</div>
								<div>
									<h2 class="text-3xl font-bold text-[#304a4d] mb-2">
										Documents n√©cessaires pour l'inscription
									</h2>
									<p class="text-[#304a4d]/70">
										T√©l√©chargez et consultez les documents requis pour votre dossier d'inscription
									</p>
								</div>
							</div>
							<div class="grid gap-4">
								{% for document in inscriptionDocuments %}
									<div class="group bg-gradient-to-r from-slate-50 to-gray-50 p-6 rounded-xl border border-slate-200 hover:border-[#304a4d]/30 hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1">
										<div class="flex items-center justify-between">
											<div class="flex items-center space-x-4">
												<div class="w-16 h-16 bg-gradient-to-br from-red-500 to-red-600 rounded-lg flex items-center justify-center shadow-md group-hover:scale-110 transition-transform duration-300">
													<span class="text-2xl">üìÑ</span>
												</div>
												<div>
													<h3 class="text-xl font-bold text-[#304a4d] group-hover:text-[#2a3f42] transition-colors">{{ document.titre }}</h3>
													{% if document.description %}
														<p class="text-sm text-[#304a4d]/70 mt-1">{{ document.description }}</p>
													{% endif %}
													{% if document.pdfUrl %}
														<span class="inline-block bg-red-100 text-red-700 text-xs px-2 py-1 rounded-full mt-2 font-medium">PDF</span>
													{% endif %}
												</div>
											</div>
											{% if document.pdfUrl %}
												<a href="{{ document.pdfUrl }}" target="_blank" class="group bg-gradient-to-r from-[#304a4d] to-[#2a3f42] hover:from-[#2a3f42] hover:to-[#1e2d30] text-white px-6 py-3 rounded-xl transition-all duration-300 inline-flex items-center shadow-lg hover:shadow-xl transform hover:scale-105">
													<svg class="w-5 h-5 mr-2 group-hover:animate-bounce" fill="none" stroke="currentColor" viewbox="0 0 24 24">
														<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
													</svg>
													<span class="font-semibold">T√©l√©charger</span>
												</a>
											{% elseif document.externalUrl %}
												<a href="{{ document.externalUrl }}" target="_blank" rel="noopener" class="group bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white px-6 py-3 rounded-xl transition-all duration-300 inline-flex items-center shadow-lg hover:shadow-xl transform hover:scale-105">
													<svg class="w-5 h-5 mr-2 group-hover:animate-pulse" fill="none" stroke="currentColor" viewbox="0 0 24 24">
														<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-2M7 13l3 3 7-7"></path>
													</svg>
													<span class="font-semibold">Consulter</span>
												</a>
											{% endif %}
										</div>
									</div>
								{% endfor %}
							</div>
						</div>
					</div>
				{% endif %}

				<!-- Messages flash -->
				{% if success %}
					<div class="animate-slide-down mb-6">
						<div class="bg-gradient-to-r from-green-500 to-emerald-500 text-white p-6 rounded-2xl shadow-xl border border-green-300/50 backdrop-blur-sm">
							<div class="flex items-center">
								<div class="w-8 h-8 bg-white/20 rounded-full flex items-center justify-center mr-4">
									<span class="text-xl">‚úÖ</span>
								</div>
								<span class="font-semibold text-lg">{{ success }}</span>
							</div>
						</div>
					</div>
				{% endif %}

				{% if error %}
					<div class="animate-slide-down mb-6">
						<div class="bg-gradient-to-r from-red-500 to-rose-500 text-white p-6 rounded-2xl shadow-xl border border-red-300/50 backdrop-blur-sm">
							<div class="flex items-center">
								<div class="w-8 h-8 bg-white/20 rounded-full flex items-center justify-center mr-4">
									<span class="text-xl">‚ùå</span>
								</div>
								<span class="font-semibold text-lg">{{ error }}</span>
							</div>
						</div>
					</div>
				{% endif %}

				<!-- Formulaire -->
				<div class="bg-white/95 backdrop-blur-md rounded-3xl shadow-2xl p-10 border border-white/50 animate-fade-in-up">
					<form
						action="/inscription-eleve" method="POST" class="space-y-8">

						<!-- Section Parent/Responsable -->
						<div class="bg-gradient-to-br from-blue-50/50 to-indigo-50/50 rounded-2xl p-8 border border-blue-100/50">
							<div class="flex items-center justify-center mb-6">
								<div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl flex items-center justify-center shadow-lg mr-4">
									<span class="text-3xl">üë§</span>
								</div>
								<h2 class="text-3xl font-bold text-[#304a4d]">
									Informations du Parent/Responsable
								</h2>
							</div>

							<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
								<div class="form-control group">
									<label class="label">
										<span class="label-text font-semibold text-[#304a4d] text-lg">Pr√©nom *</span>
									</label>
									<input type="text" name="parentFirstName" class="input input-bordered w-full h-14 text-lg bg-white/80 border-2 border-gray-200 focus:border-[#304a4d] focus:bg-white transition-all duration-300 rounded-xl shadow-sm hover:shadow-md" required placeholder="Votre pr√©nom">
								</div>

								<div class="form-control group">
									<label class="label">
										<span class="label-text font-semibold text-[#304a4d] text-lg">Nom *</span>
									</label>
									<input type="text" name="parentLastName" class="input input-bordered w-full h-14 text-lg bg-white/80 border-2 border-gray-200 focus:border-[#304a4d] focus:bg-white transition-all duration-300 rounded-xl shadow-sm hover:shadow-md" required placeholder="Votre nom de famille">
								</div>

								<div class="form-control group">
									<label class="label">
										<span class="label-text font-semibold text-[#304a4d] text-lg">Email *</span>
									</label>
									<input type="email" name="parentEmail" class="input input-bordered w-full h-14 text-lg bg-white/80 border-2 border-gray-200 focus:border-[#304a4d] focus:bg-white transition-all duration-300 rounded-xl shadow-sm hover:shadow-md" required placeholder="votre.email@exemple.com">
								</div>

								<div class="form-control group">
									<label class="label">
										<span class="label-text font-semibold text-[#304a4d] text-lg">T√©l√©phone *</span>
									</label>
									<input type="tel" name="parentPhone" class="input input-bordered w-full h-14 text-lg bg-white/80 border-2 border-gray-200 focus:border-[#304a4d] focus:bg-white transition-all duration-300 rounded-xl shadow-sm hover:shadow-md" required placeholder="06 12 34 56 78">
								</div>

								<div class="form-control md:col-span-2 group">
									<label class="label">
										<span class="label-text font-semibold text-[#304a4d] text-lg">Adresse compl√®te *</span>
									</label>
									<textarea name="parentAddress" class="textarea textarea-bordered w-full text-lg bg-white/80 border-2 border-gray-200 focus:border-[#304a4d] focus:bg-white transition-all duration-300 rounded-xl shadow-sm hover:shadow-md" rows="3" required placeholder="Adresse, code postal, ville"></textarea>
								</div>
							</div>
						</div>

						<!-- Section Ann√©e Scolaire -->
						<div class="border-b border-gray-200 pb-6">
							<h2 class="text-2xl font-semibold text-[#304a4d] text-center mb-4">
								üìÖ Ann√©e Scolaire
							</h2>

							<div class="form-control max-w-md mx-auto">
								<label class="label">
									<span class="label-text font-medium text-lg">Pour quelle ann√©e scolaire souhaitez-vous inscrire votre/vos enfant(s) ? *</span>
								</label>
								<select name="anneeScolaire" class="select select-bordered w-full text-lg" required>
									<option value="2025/2026" selected>2025/2026 (Ann√©e en cours)</option>
									<option value="2026/2027">2026/2027 (Prochaine ann√©e)</option>
									<option value="2027/2028">2027/2028</option>
								</select>
								<div class="label">
									<span class="label-text-alt text-gray-600">
										‚ö†Ô∏è S√©lectionnez l'ann√©e scolaire concern√©e par votre demande
									</span>
								</div>
							</div>
						</div>

						<!-- Section Enfants -->
						<div class="border-b border-gray-200 pb-6">
							<div class="text-center mb-6">
								<h2 class="text-2xl font-semibold text-[#304a4d]">
									üë∂ Enfant(s) √† Inscrire
								</h2>
							</div>
							<div class="flex justify-end mb-4">
								<button type="button" id="addChildBtn" class="btn btn-outline btn-sm bg-[#304a4d] text-white hover:bg-[#2a3f42] shadow-lg font-semibold border border-white/20">
									‚ûï Ajouter un autre enfant
								</button>
							</div>

							<div
								id="childrenContainer" class="space-y-6">
								<!-- Premier enfant (par d√©faut) -->
								<div class="child-form bg-slate-50 p-4 rounded-lg border border-slate-200 relative" data-child-index="0">
									<div class="flex justify-between items-center mb-4">
										<h3 class="text-lg font-semibold text-[#304a4d]">Enfant 1</h3>
										<button type="button" class="remove-child-btn btn btn-outline btn-xs text-red-600 hover:bg-red-50 shadow-md font-semibold bg-white border-2 border-red-200" style="display: none;">
											üóëÔ∏è Supprimer
										</button>
									</div>

									<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
										<div class="form-control">
											<label class="label">
												<span class="label-text font-medium">Pr√©nom de l'enfant *</span>
											</label>
											<input type="text" name="children[0][firstName]" class="input input-bordered w-full" required>
										</div>

										<div class="form-control">
											<label class="label">
												<span class="label-text font-medium">Nom de l'enfant *</span>
											</label>
											<input type="text" name="children[0][lastName]" class="input input-bordered w-full" required>
										</div>

										<div class="form-control">
											<label class="label">
												<span class="label-text font-medium">Date de naissance *</span>
											</label>
											<input type="date" name="children[0][birthDate]" class="input input-bordered w-full" required>
										</div>

										<div class="form-control">
											<label class="label">
												<span class="label-text font-medium">Classe actuelle</span>
											</label>
											<select name="children[0][currentClass]" class="select select-bordered w-full">
												<option value="">S√©lectionner...</option>
												<option value="TPS">TPS (Toute Petite Section)</option>
												<option value="PS">PS (Petite Section)</option>
												<option value="MS">MS (Moyenne Section)</option>
												<option value="GS">GS (Grande Section)</option>
												<option value="CP">CP</option>
												<option value="CE1">CE1</option>
												<option value="CE2">CE2</option>
												<option value="CM1">CM1</option>
												<option value="CM2">CM2</option>
												<option value="Premi√®re_inscription">Premi√®re inscription</option>
												<option value="Autre_√©cole">Autre √©cole</option>
											</select>
										</div>

										<div class="form-control">
											<label class="label">
												<span class="label-text font-medium">Classe demand√©e *</span>
											</label>
											<select name="children[0][requestedClass]" class="select select-bordered w-full" required>
												<option value="">S√©lectionner la classe souhait√©e...</option>
												<option value="PS">PS (Petite Section)</option>
												<option value="MS">MS (Moyenne Section)</option>
												<option value="GS">GS (Grande Section)</option>
												<option value="CP">CP</option>
												<option value="CE1">CE1</option>
												<option value="CE2">CE2</option>
												<option value="CM1">CM1</option>
												<option value="CM2">CM2</option>
											</select>
										</div>

										<div class="form-control">
											<label class="label">
												<span class="label-text font-medium">√âcole pr√©c√©dente</span>
											</label>
											<input type="text" name="children[0][previousSchool]" class="input input-bordered w-full" placeholder="Nom de l'√©cole pr√©c√©dente (si applicable)">
										</div>
									</div>
								</div>
							</div>
						</div>

						<!-- Section Informations Compl√©mentaires -->
						<div class="pb-6">
							<h2 class="text-2xl font-semibold text-[#304a4d] mb-4">
								üìã Informations Compl√©mentaires
							</h2>

							<div class="space-y-4">
								<div class="form-control">
									<label class="label">
										<span class="label-text font-medium">Besoins particuliers ou PAI</span>
									</label>
									<textarea name="specialNeeds" class="textarea textarea-bordered w-full" rows="3" placeholder="Allergie, handicap, troubles d'apprentissage, etc. (facultatif)"></textarea>
								</div>

								<div class="form-control">
									<label class="label">
										<span class="label-text font-medium">Message ou demande particuli√®re</span>
									</label>
									<textarea name="message" class="textarea textarea-bordered w-full" rows="4" placeholder="Votre message pour l'√©quipe p√©dagogique (facultatif)"></textarea>
								</div>
							</div>
						</div>

						<!-- Informations importantes -->
						<div class="bg-blue-50 p-6 rounded-lg">
							<h3 class="text-lg font-semibold text-[#304a4d] mb-3">
								‚ÑπÔ∏è Informations importantes
							</h3>
							<ul class="list-disc list-inside space-y-2 text-[#304a4d]/80">
								<li>Cette demande de pr√©-inscription sera examin√©e par l'√©quipe de direction</li>
								<li>Vous recevrez d'abord un email de validation √† confirmer</li>
								<li>Apr√®s validation, la direction recevra votre demande et reviendra vers vous pour une prise de rendez-vous</li>
								<li>En cas d'acceptation, vous compl√®terez le dossier d'inscription avec la secr√©taire</li>
								<li>Vous pourrez ensuite faire une demande d'identifiants sur notre site: https://www.stmathieu.org</li>
								
							</ul>
						</div>

						<!-- Bouton de soumission -->
						<div class="text-center pt-8">
							<div class="relative">
								<button
									type="submit" class="group relative bg-gradient-to-r from-[#304a4d] via-[#2a3f42] to-[#304a4d] hover:from-[#2a3f42] hover:via-[#1e2d30] hover:to-[#2a3f42] text-white text-xl px-12 py-4 rounded-2xl font-bold border-2 border-white/20 shadow-2xl hover:shadow-3xl transition-all duration-300 transform hover:scale-105 hover:-translate-y-1 overflow-hidden">
									<!-- Effet brillant anim√© -->
									<div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent transform -skew-x-12 translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000"></div>
									<div class="relative flex items-center justify-center">
										<span class="text-2xl mr-3 group-hover:animate-bounce">üì§</span>
										<span class="font-black tracking-wide">Envoyer la demande de pr√©-inscription</span>
									</div>
								</button>

								<!-- Particules d√©coratives autour du bouton -->
								<div class="absolute -top-2 -left-2 w-4 h-4 bg-[#8dd3cc] rounded-full animate-ping"></div>
								<div class="absolute -bottom-2 -right-2 w-3 h-3 bg-[#a7e3dd] rounded-full animate-pulse"></div>
							</div>

							<!-- Message encourageant -->
							<p class="mt-4 text-[#304a4d]/80 font-medium animate-fade-in" style="animation-delay: 0.5s;">
								‚ú® Votre demande sera trait√©e avec attention
							</p>
						</div>
					</form>
				</div>

				<!-- Informations de contact -->
				<div class="mt-8 text-center animate-fade-in-up" style="animation-delay: 1s;">
					<div class="bg-white/60 backdrop-blur-md rounded-2xl p-8 shadow-xl border border-white/30">
						<div class="flex items-center justify-center mb-4">
							<div class="w-12 h-12 bg-gradient-to-br from-[#304a4d] to-[#2a3f42] rounded-xl flex items-center justify-center mr-4 shadow-lg">
								<span class="text-2xl">üìû</span>
							</div>
							<h3 class="text-2xl font-bold text-[#304a4d]">
								Besoin d'aide ?
							</h3>
						</div>
						<div class="space-y-2">
							<p class="text-[#304a4d] font-semibold text-lg">
								Contactez le secr√©tariat
							</p>
							<div class="flex flex-col sm:flex-row justify-center items-center gap-4 mt-4">
								<div class="bg-[#304a4d]/10 px-6 py-3 rounded-xl">
									<span class="text-[#304a4d] font-bold text-lg">üìû 04 91 07 07 18</span>
								</div>
								<div class="bg-[#304a4d]/10 px-6 py-3 rounded-xl">
									<span class="text-[#304a4d] font-bold text-lg">‚úâÔ∏è ecole-saint-mathieu@wanadoo.fr</span>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<script>
		// Variables globales
let childIndex = 1;
// Commence √† 1 car nous avons d√©j√† l'enfant 0

// Charger les donn√©es d'inscription (sous-titre et documents)
async function loadInscriptionData() {
try {
const response = await fetch('/inscription-management/data');
const data = await response.json();

if (data.success) { // Mettre √† jour le sous-titre
if (data.config && data.config.soustitre) {
document.getElementById('inscriptionSubtitle').textContent = data.config.soustitre;
}

// Afficher/masquer l'annonce PS 2026
if (data.config && data.config.afficherAnnoncePS2026) {
document.getElementById('annoncePS2026').style.display = 'block';
}

// Afficher les documents s'il y en a
if (data.documents && data.documents.length > 0) {
displayDocuments(data.documents);
}
}
} catch (error) {
console.error('Erreur lors du chargement des donn√©es d\'inscription:', error);
}
}

function displayDocuments(documents) {
const documentsSection = document.getElementById('documentsSection');
const documentsList = document.getElementById('documentsList');

documentsList.innerHTML = '';

documents.forEach(document => {
const documentDiv = document.createElement('div');
documentDiv.className = 'flex items-center justify-between bg-slate-50 p-4 rounded-lg border border-slate-200';

const fileSize = (document.taille / 1024 / 1024).toFixed(2);

documentDiv.innerHTML = `
            <div class="flex items-center space-x-3">
                <span class="text-red-500 text-2xl">üìÑ</span>
                <div>
                    <h3 class="font-semibold text-[#304a4d]">${
document.nom
}</h3>
                    ${
document.description ? `<p class="text-sm text-[#304a4d]/70">${
document.description
}</p>` : ''
}
                    <p class="text-xs text-[#304a4d]/60">${fileSize} MB</p>
                </div>
            </div>
            <a href="/inscription-management/documents/${
document.id
}/download" 
               class="bg-[#304a4d] hover:bg-[#2a3f42] text-white px-4 py-2 rounded-lg transition-colors inline-flex items-center">
                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                </svg>
                T√©l√©charger
            </a>
        `;

documentsList.appendChild(documentDiv);
});

documentsSection.style.display = 'block';
}

// Fonction pour ajouter un nouvel enfant
function addChild() {
const container = document.getElementById('childrenContainer');
const newChildDiv = document.createElement('div');
newChildDiv.className = 'child-form bg-slate-50 p-4 rounded-lg border border-slate-200 relative';
newChildDiv.setAttribute('data-child-index', childIndex);

newChildDiv.innerHTML = `
        <div class="flex justify-between items-center mb-4">
            <h3 class="text-lg font-semibold text-[#304a4d]">Enfant ${
childIndex + 1
}</h3>
            <button type="button" class="remove-child-btn btn btn-outline btn-xs text-red-600 hover:bg-red-50 shadow-md font-semibold bg-white border-2 border-red-200">
                üóëÔ∏è Supprimer
            </button>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="form-control">
                <label class="label">
                    <span class="label-text font-medium">Pr√©nom de l'enfant *</span>
                </label>
                <input type="text" name="children[${childIndex}][firstName]" class="input input-bordered w-full" required>
            </div>

            <div class="form-control">
                <label class="label">
                    <span class="label-text font-medium">Nom de l'enfant *</span>
                </label>
                <input type="text" name="children[${childIndex}][lastName]" class="input input-bordered w-full" required>
            </div>

            <div class="form-control">
                <label class="label">
                    <span class="label-text font-medium">Date de naissance *</span>
                </label>
                <input type="date" name="children[${childIndex}][birthDate]" class="input input-bordered w-full" required>
            </div>

            <div class="form-control">
                <label class="label">
                    <span class="label-text font-medium">Classe actuelle</span>
                </label>
                <select name="children[${childIndex}][currentClass]" class="select select-bordered w-full">
                    <option value="">S√©lectionner...</option>
                    <option value="TPS">TPS (Toute Petite Section)</option>
                    <option value="PS">PS (Petite Section)</option>
                    <option value="MS">MS (Moyenne Section)</option>
                    <option value="GS">GS (Grande Section)</option>
                    <option value="CP">CP</option>
                    <option value="CE1">CE1</option>
                    <option value="CE2">CE2</option>
                    <option value="CM1">CM1</option>
                    <option value="CM2">CM2</option>
                    <option value="Premi√®re_inscription">Premi√®re inscription</option>
                    <option value="Autre_√©cole">Autre √©cole</option>
                </select>
            </div>

            <div class="form-control">
                <label class="label">
                    <span class="label-text font-medium">Classe demand√©e *</span>
                </label>
                <select name="children[${childIndex}][requestedClass]" class="select select-bordered w-full" required>
                    <option value="">S√©lectionner la classe souhait√©e...</option>
                    <option value="PS">PS (Petite Section)</option>
                    <option value="MS">MS (Moyenne Section)</option>
                    <option value="GS">GS (Grande Section)</option>
                    <option value="CP">CP</option>
                    <option value="CE1">CE1</option>
                    <option value="CE2">CE2</option>
                    <option value="CM1">CM1</option>
                    <option value="CM2">CM2</option>
                </select>
            </div>

            <div class="form-control">
                <label class="label">
                    <span class="label-text font-medium">√âcole pr√©c√©dente</span>
                </label>
                <input type="text" name="children[${childIndex}][previousSchool]" class="input input-bordered w-full" placeholder="Nom de l'√©cole pr√©c√©dente (si applicable)">
            </div>
        </div>
    `;

container.appendChild(newChildDiv);
childIndex++;

// Mettre √† jour l'affichage des boutons supprimer
updateRemoveButtons();
}

// Fonction pour supprimer un enfant
function removeChild(element) {
const childForm = element.closest('.child-form');
childForm.remove();

// Renum√©roter les enfants restants
renumberChildren();
updateRemoveButtons();
}

// Fonction pour renum√©roter les enfants apr√®s suppression
function renumberChildren() {
const childForms = document.querySelectorAll('.child-form');
childForms.forEach((form, index) => {
form.setAttribute('data-child-index', index);

// Mettre √† jour le titre
const title = form.querySelector('h3');
title.textContent = `Enfant ${
index + 1
}`;

// Mettre √† jour les noms des inputs
const inputs = form.querySelectorAll('input, select');
inputs.forEach(input => {
const name = input.getAttribute('name');
if (name && name.includes('children[')) {
const newName = name.replace(/children\[\d+\]/, `children[${index}]`);
input.setAttribute('name', newName);
}
});
});

// Mettre √† jour l'index pour les prochains ajouts
childIndex = childForms.length;
}

// Fonction pour mettre √† jour l'affichage des boutons supprimer
function updateRemoveButtons() {
const childForms = document.querySelectorAll('.child-form');
const removeButtons = document.querySelectorAll('.remove-child-btn');

// Montrer/cacher les boutons supprimer selon le nombre d'enfants
removeButtons.forEach(btn => {
if (childForms.length > 1) {
btn.style.display = 'inline-block';
} else {
btn.style.display = 'none';
}
});
}

// Charger les donn√©es au chargement de la page
document.addEventListener('DOMContentLoaded', function () {
loadInscriptionData();

// G√©rer l'ajout d'enfants
document.getElementById('addChildBtn').addEventListener('click', addChild);

// G√©rer la suppression d'enfants (d√©l√©gation d'√©v√©nement)
document.addEventListener('click', function (e) {
if (e.target.classList.contains('remove-child-btn') || e.target.closest('.remove-child-btn')) {
const button = e.target.classList.contains('remove-child-btn') ? e.target : e.target.closest('.remove-child-btn');
removeChild(button);
}
});

// Initialiser l'affichage des boutons
updateRemoveButtons();

});
	</script>
{% endblock %}
