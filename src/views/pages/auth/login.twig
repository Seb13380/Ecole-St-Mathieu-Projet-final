{% extends "layouts/base.twig" %}

{% block title %}
	<title>Connexion - École Saint-Mathieu
	</title>
{% endblock %}

{% block main %}
	<div class="min-h-[600px] flex items-center justify-center py-8">
		<div class="w-full max-w-4xl space-y-6 min-h-[600px] py-8 bg-white/80 border-4 border-teal-300 shadow-lg">
			<div>
				<h2 class="mt-4 text-center text-5xl font-extrabold text-gray-900">
					Connexion à votre compte
				</h2>
				<p class="mt-2 text-center text-3xl text-gray-600">
					École Saint-Mathieu
				</p>
			</div>

			<form class="mt-6 space-y-4" action="/auth/login" method="POST">
				{% if error %}
					<div class="alert alert-error">
						<svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewbox="0 0 24 24">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"/>
						</svg>
						<span>
							{% if error == 'invalid_token' %}
								Le lien de réinitialisation est invalide ou a expiré. Demandez un nouveau lien.
							{% elseif error == 'system_error' %}
								Une erreur système s'est produite. Veuillez réessayer plus tard.
							{% else %}
								{{ error }}
							{% endif %}
						</span>
					</div>
				{% endif %}

				{% if success %}
					<div class="bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg relative" role="alert">
						<div class="flex items-center">
							<svg class="w-4 h-4 mr-2" fill="currentColor" viewbox="0 0 20 20">
								<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
							</svg>
							<span>
								{% if success == 'password_reset' %}
									✅ Votre mot de passe a été modifié avec succès ! Vous pouvez maintenant vous connecter.
								{% else %}
									{{ success }}
								{% endif %}
							</span>
						</div>
					</div>
				{% endif %}

				<div class="form-control text-center px-5">
					<label class="label">
						<span class="label-text text-center w-full">Email</span>
					</label>
					<input type="email" name="email" value="{{ email }}" placeholder="votre@email.com" class="input border-2 border-teal-300 focus:border-teal-600 focus:outline-none w-full rounded-lg px-3 py-2 text-center w-full" required>
				</div>

				<div class="form-control text-center px-5">
					<label class="label">
						<span class="label-text text-center w-full">Mot de passe</span>
					</label>
					<input type="password" name="password" placeholder="Votre mot de passe" class="input border-2 border-teal-300 focus:border-teal-600 focus:outline-none w-full rounded-lg px-3 py-2 text-center w-full" required>
					<label class="label">
						<a href="/auth/forgot-password" class="text-teal-600 hover:text-teal-800 text-sm underline text-center w-full">
							Mot de passe oublié ?
						</a>
					</label>
				</div>

				<div class="form-control mt-6 text-center px-4">
					<div class="w-full flex justify-center">
						<button type="submit" class="bg-teal-600 hover:bg-teal-700 text-white font-bold px-8 py-3 rounded-full shadow-xl transition-all duration-300 transform hover:scale-110 active:scale-95 focus:outline-none focus:ring-4 focus:ring-teal-300 text-base min-w-[200px] border-2 border-teal-800 hover:shadow-2xl glow-effect">
							✨ Se connecter
						</button>
					</div>
				</div>

				<div class="text-center space-y-3">
					<p class="text-sm text-gray-600">
						Identifiants oubliés ?
						<a href="/demande-identifiants" class="text-amber-600 hover:text-amber-800 font-medium underline">
							Demander mes codes d'accès
						</a>
					</p>
					<p class="text-sm text-gray-600">
						Pas encore de compte ?
						<a href="/auth/register" class="text-teal-600 hover:text-teal-800 font-medium underline">
							Inscrire mon enfant
						</a>
					</p>
				</div>
			</form>
		</div>
	</div>
{% endblock %}
