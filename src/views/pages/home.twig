{% extends "layouts/base.twig" %}

{% block title %}École Saint-Mathieu - Accueil
{% endblock %}

{% block main %}

	<div class="p-8 md:p-24">
		<div class="flex items-center justify-between py-8 gap-8">
			<div class="flex-1 text-center">
				<h1 class="text-6xl md:text-6xl font-bold text-[#304a4d] mb-4">
					Bienvenue à l'École Saint-Mathieu
				</h1>
				<p class="text-xl text-[#304a4d] opacity-80">
					L'école Saint Mathieu est ouverte à tous, conformément à la volonté de l'Eglise catholique de
																																																																																																																																											mettre à la disposition de tous ses orientations éducatives. Elle est associée à l'Etat par contrat dans le
																																																																																																																																											cadre de la loi Debré de 1959.
																																																																																																																																											Ce projet, propre à l'école Saint Mathieu, puise sa source dans l'Evangile. Ses propositions
																																																																																																																																											éducatives se fondent sur la vision chrétienne de la personne humaine, partagée par tous les
																																																																																																																																											établissements catholiques.
				</p>
			</div>

			<div class="flex-none">
				<a href="https://app.educartable.com/accounts-portal/" target="_blank" rel="noopener" class="flex items-center gap-6">
					<img src="/assets/images/educartable2.png" alt="Logo Educartable" class="w-auto object-contain rounded-xl shadow-md hover:scale-105 transition-all duration-300" style="height: 140px; animation: pulse-glow 4s ease-in-out infinite;"/>
					<span class="text-xl font-bold text-[#304a4d]"></span>
				</a>
			</div>
		</div>

		<div class="w-full">
			{% if heroCarouselImages and heroCarouselImages|length > 0 %}
				<div id="default-carousel" class="relative w-full" data-carousel="slide" data-carousel-interval="5000">
					<div class="relative h-[900px] overflow-hidden">
						{% for image in heroCarouselImages %}
							<div data-carousel-item {% if loop.first %}="active" {% endif %} class="{% if not loop.first %}hidden {% endif %}duration-700 ease-in-out relative">
								<img src="/uploads/hero-carousel/{{ image.filename }}" class="block w-full h-full object-cover" alt="{{ image.titre ?: 'École Saint-Mathieu' }}">
								{% if image.titre or image.description %}
									<div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-6">
										{% if image.titre %}
											<h3 class="text-white text-2xl font-bold mb-2 drop-shadow-lg">{{ image.titre }}</h3>
										{% endif %}
										{% if image.description %}
											<p class="text-white text-lg drop-shadow-lg">{{ image.description }}</p>
										{% endif %}
									</div>
								{% endif %}
							</div>
						{% endfor %}
					</div>

					{% if heroCarouselImages|length > 1 %}
						<div class="absolute z-30 flex -translate-x-1/2 bottom-5 left-1/2 space-x-3">
							{% for image in heroCarouselImages %}
								<button type="button" class="w-3 h-3 rounded-full bg-white/50 hover:bg-white" aria-current="{% if loop.first %}true{% else %}false{% endif %}" aria-label="Slide {{ loop.index }}" data-carousel-slide-to="{{ loop.index0 }}"></button>
							{% endfor %}
						</div>
					{% endif %}

					<!-- Boutons de navigation -->
					{% if (heroCarouselImages and heroCarouselImages|length > 1) or (not heroCarouselImages or heroCarouselImages|length == 0) %}
						<button type="button" class="absolute top-0 left-0 z-30 flex items-center justify-center h-full px-4 cursor-pointer group focus:outline-none" data-carousel-prev>
							<span class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/30 group-hover:bg-white/50 group-focus:ring-4 group-focus:ring-white group-focus:outline-none">
								<svg class="w-4 h-4 text-white rtl:rotate-180" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 6 10">
									<path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 1 1 5l4 4"/>
								</svg>
								<span class="sr-only">Précédent</span>
							</span>
						</button>

						<button type="button" class="absolute top-0 right-0 z-30 flex items-center justify-center h-full px-4 cursor-pointer group focus:outline-none" data-carousel-next>
							<span class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/30 group-hover:bg-white/50 group-focus:ring-4 group-focus:ring-white group-focus:outline-none">
								<svg class="w-4 h-4 text-white rtl:rotate-180" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 6 10">
									<path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 9 4-4-4-4"/>
								</svg>
								<span class="sr-only">Suivant</span>
							</span>
						</button>
					{% endif %}
				</div>
			{% else %}
				<!-- Fallback: afficher le carousel statique si aucune image dynamique -->
				<div id="default-carousel" class="relative w-full" data-carousel="slide" data-carousel-interval="5000">
					<div
						class="relative h-[900px] overflow-hidden">
						<!-- Item 1 -->
						<div data-carousel-item="active" class="duration-700 ease-in-out">
							<img src="/assets/images/20250326_114849.jpg" class="block w-full h-full object-cover" alt="École Saint-Mathieu">
						</div>
						<!-- Item 2 -->
						<div data-carousel-item class="hidden duration-700 ease-in-out">
							<img src="/assets/images/20250326_114954.jpg" class="block w-full h-full object-cover" alt="Activités scolaires">
						</div>
						<!-- Item 3 -->
						<div data-carousel-item class="hidden duration-700 ease-in-out">
							<img src="/assets/images/47d2b2f0-69d4-4913-b80c-5da660a12e2e.jpg" class="block w-full h-full object-cover" alt="Cour de récréation">
						</div>
					</div>

					<div class="absolute z-30 flex -translate-x-1/2 bottom-5 left-1/2 space-x-3">
						<button type="button" class="w-3 h-3 rounded-full bg-white/50 hover:bg-white" aria-current="true" aria-label="Slide 1" data-carousel-slide-to="0"></button>
						<button type="button" class="w-3 h-3 rounded-full bg-white/50 hover:bg-white" aria-current="false" aria-label="Slide 2" data-carousel-slide-to="1"></button>
						<button type="button" class="w-3 h-3 rounded-full bg-white/50 hover:bg-white" aria-current="false" aria-label="Slide 3" data-carousel-slide-to="2"></button>
					</div>

					<!-- Boutons de navigation pour le fallback -->
					<button type="button" class="absolute top-0 left-0 z-30 flex items-center justify-center h-full px-4 cursor-pointer group focus:outline-none" data-carousel-prev>
						<span class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/30 group-hover:bg-white/50 group-focus:ring-4 group-focus:ring-white group-focus:outline-none">
							<svg class="w-4 h-4 text-white rtl:rotate-180" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 6 10">
								<path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 1 1 5l4 4"/>
							</svg>
							<span class="sr-only">Précédent</span>
						</span>
					</button>

					<button type="button" class="absolute top-0 right-0 z-30 flex items-center justify-center h-full px-4 cursor-pointer group focus:outline-none" data-carousel-next>
						<span class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/30 group-hover:bg-white/50 group-focus:ring-4 group-focus:ring-white group-focus:outline-none">
							<svg class="w-4 h-4 text-white rtl:rotate-180" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 6 10">
								<path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 9 4-4-4-4"/>
							</svg>
							<span class="sr-only">Suivant</span>
						</span>
					</button>
				</div>
			{% endif %}
		</div>
	</div>

	<div>
		<h2 class="text-4xl font-bold text-[#304a4d] mb-10 text-center">Actualités & Travaux</h2>
		<div
			class="flex flex-row gap-8 mt-4 mb-12 justify-center items-start max-w-7xl mx-auto">
			<!-- Section Images - 2/3 -->
			<div class="w-full md:w-2/3 flex flex-col">
				<div class="card bg-white rounded-xl p-6 shadow-lg">
					<h3 class="text-2xl font-bold text-[#304a4d] mb-6 text-center">"Les Echos liés de St Mathieu"</h3>

					<!-- Mini carousel d'images -->
					<div id="actualites-carousel" class="relative" data-carousel="slide" data-carousel-interval="4000">
						<div class="relative h-96 overflow-hidden rounded-lg">
							{% if carouselImages and carouselImages|length > 0 %}
								{% for image in carouselImages %}
									<div data-carousel-item {% if loop.index0 == 0 %} ="active" {% endif %} class="{% if loop.index0 == 0 %}duration-1000 ease-in-out{% else %}hidden duration-1000 ease-in-out{% endif %}">
										<img src="/uploads/carousel/{{ image.filename }}" class="block w-full h-full object-cover" alt="{{ image.titre ?: 'Image carrousel' }}">
										{% if image.titre or image.description %}
											<div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent text-white p-6">
												{% if image.titre %}
													<h4 class="font-bold text-lg text-white drop-shadow-lg">{{ image.titre }}</h4>
												{% endif %}
												{% if image.description %}
													<p class="text-sm text-gray-200 drop-shadow-md">{{ image.description }}</p>
												{% endif %}
											</div>
										{% endif %}
									</div>
								{% endfor %}
							{% else %}
								<!-- Images par défaut si aucune image n'est uploadée -->
								<div data-carousel-item="active" class="duration-1000 ease-in-out">
									<img src="/assets/images/20250326_114849.jpg" class="block w-full h-full object-cover" alt="Actualités école">
									<div class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white p-4">
										<h4 class="font-bold">Rentrée scolaire 2025</h4>
										<p class="text-sm">Préparatifs en cours pour accueillir nos élèves</p>
									</div>
								</div>
								<div data-carousel-item class="hidden duration-1000 ease-in-out">
									<img src="/assets/images/20250710_123601.jpg" class="block w-full h-full object-cover" alt="Travaux école">
									<div class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white p-4">
										<h4 class="font-bold">Rénovation en cours</h4>
										<p class="text-sm">Amélioration des espaces de vie scolaire</p>
									</div>
								</div>
								<div data-carousel-item class="hidden duration-1000 ease-in-out">
									<img src="/assets/images/entreePrincipale.jpg" class="block w-full h-full object-cover" alt="Vie scolaire">
									<div class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white p-4">
										<h4 class="font-bold">Vie de l'école</h4>
										<p class="text-sm">Moments de partage et d'apprentissage</p>
									</div>
								</div>
								<div data-carousel-item class="hidden duration-1000 ease-in-out">
									<img src="/assets/images/20250710_123943.jpg" class="block w-full h-full object-cover" alt="Projets école">
									<div class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white p-4">
										<h4 class="font-bold">Nouveaux projets</h4>
										<p class="text-sm">Innovation et modernisation continue</p>
									</div>
								</div>
							{% endif %}
						</div>

						<!-- Navigation carousel -->
						<div class="absolute z-30 flex -translate-x-1/2 bottom-2 left-1/2 space-x-2">
							{% if carouselImages and carouselImages|length > 0 %}
								{% for image in carouselImages %}
									<button type="button" class="w-2 h-2 rounded-full bg-white/70 hover:bg-white" data-carousel-slide-to="{{ loop.index0 }}"></button>
								{% endfor %}
							{% else %}
								<button type="button" class="w-2 h-2 rounded-full bg-white/70 hover:bg-white" data-carousel-slide-to="0"></button>
								<button type="button" class="w-2 h-2 rounded-full bg-white/70 hover:bg-white" data-carousel-slide-to="1"></button>
								<button type="button" class="w-2 h-2 rounded-full bg-white/70 hover:bg-white" data-carousel-slide-to="2"></button>
								<button type="button" class="w-2 h-2 rounded-full bg-white/70 hover:bg-white" data-carousel-slide-to="3"></button>
							{% endif %}
						</div>
					</div>
				</div>
			</div>

			<!-- Section Texte - 1/3 -->
			<div class="w-full md:w-1/3 flex flex-col">
				<div class="card bg-white rounded-xl p-6 shadow-lg h-full">
					<h3 class="text-xl font-bold text-[#304a4d] mb-4 text-center">📰 Actualités</h3>
					<div class="space-y-3 mb-6">
						{% if actualites and actualites|length > 0 %}
							{% for actualite in actualites|slice(0, 3) %}
								<div class="border-l-4 border-[#a7e3dd] pl-3">
									<h4 class="text-sm font-semibold text-[#304a4d] mb-1 {{ actualite.important ? 'text-red-600' : '' }}">
										{{ actualite.important ? '🚨 ' : '' }}{{ actualite.titre }}
									</h4>
									<p class="text-xs text-gray-700 mb-1">{{ actualite.contenu|length > 80 ? actualite.contenu|slice(0, 80) ~ '...' : actualite.contenu }}</p>
									<span class="text-xs text-gray-500">📅
										{{ actualite.datePublication|date('d/m/Y') }}</span>
								</div>
							{% endfor %}

						{% endif %}
					</div>

					<h3 class="text-xl font-bold text-[#304a4d] mb-4 text-center">🔨 Travaux</h3>
					<div class="space-y-3">
						{% if travaux and travaux|length > 0 %}
							{% for travail in travaux %}
								<div class="border-l-4 border-{% if travail.important %}red-500{% else %}[#304a4d]{% endif %} pl-3">
									<div class="flex items-center gap-2 mb-1">
										<h4 class="text-sm font-semibold text-[#304a4d]">{{ travail.titre }}</h4>
										{% if travail.important %}
											<span class="text-xs bg-red-100 text-red-600 px-2 py-1 rounded">Important</span>
										{% endif %}
									</div>
									<p class="text-xs text-gray-700 mb-2">{{ travail.description|length > 80 ? travail.description[:80] ~ '...' : travail.description }}</p>
									<div class="w-full bg-gray-200 rounded-full h-1 mb-1">
										<div class="bg-[#a7e3dd] h-1 rounded-full" style="width: {{ travail.progression }}%"></div>
									</div>
									<div class="flex items-center justify-between">
										<span class="text-xs text-gray-500">🔧
											{{ travail.progression }}%</span>
										<span class="text-xs text-gray-400">
											{% if travail.statut == 'EN_COURS' %}🚧 En cours
											{% endif %}
											{% if travail.statut == 'TERMINE' %}✅ Terminé
											{% endif %}
											{% if travail.statut == 'PLANIFIE' %}📋 Planifié
											{% endif %}
											{% if travail.statut == 'SUSPENDU' %}⏸️ Suspendu
											{% endif %}
										</span>
									</div>
								</div>
							{% endfor %}
						{% else %}
							<div class="border-l-4 border-[#304a4d] pl-3">
								<h4 class="text-sm font-semibold text-[#304a4d] mb-1">Rénovation cour</h4>
								<p class="text-xs text-gray-700 mb-2">Nouveaux jeux et revêtement prévu pour septembre.</p>
								<div class="w-full bg-gray-200 rounded-full h-1 mb-1">
									<div class="bg-[#a7e3dd] h-1 rounded-full" style="width: 75%"></div>
								</div>
								<span class="text-xs text-gray-500">🔧 75%</span>
							</div>

							<div class="border-l-4 border-[#304a4d] pl-3">
								<h4 class="text-sm font-semibold text-[#304a4d] mb-1">Tableaux numériques</h4>
								<p class="text-xs text-gray-700 mb-2">Équipement de toutes les classes.</p>
								<div class="w-full bg-gray-200 rounded-full h-1 mb-1">
									<div class="bg-[#a7e3dd] h-1 rounded-full" style="width: 45%"></div>
								</div>
								<span class="text-xs text-gray-500">🔧 45%</span>
							</div>
						{% endif %}
					</div>
				</div>
			</div>
		</div>
	</div>
{% endblock %}
{% block styles %}
	{{ parent() }}<style>
		/* Unique override utile : bien couvrir le conteneur */
		[data-carousel="slide"] img {
			object-fit: cover;
			object-position: center;
			width: 100%;
			height: 100%;
		}

		/* Style spécifique pour l'image de la chapelle */
		[data-carousel="slide"] img[src*="entreeChapelle"] {
			object-fit: contain;
		}

		/* Style spécifique pour entreeChapelle2 - prend toute la largeur */
		[data-carousel="slide"] img[src*="entreeChapelle2"] {
			object-fit: cover !important;
			object-position: center;
		}

		/* Ajouter un espace entre les cartes et la carte Google Maps */
		.flex.flex-row.gap-8.mt-4.mb-12 {
			margin-bottom: 80px !important;
		}

		.flex.justify-center.mt-16.mb-8 {
			margin-top: 80px !important;
		}

		/* Animation moderne pulse-glow pour le logo Educartable */
		@keyframes pulse-glow {
			0,
			100% {
				opacity: 1;
				filter: drop-shadow(0 0 5px rgba(167, 227, 221, 0.3));
				transform: scale(1);
			}
			50% {
				opacity: 0.9;
				filter: drop-shadow(0 0 15px rgba(167, 227, 221, 0.6));
				transform: scale(1.02);
			}
		}
	</style>
{% endblock %}
{% block scripts %}
	{{ parent() }}<!-- Bundle Flowbite (initialise automatiquement tous les carousels data-carousel) --><script src="https://unpkg.com/flowbite@latest/dist/flowbite.bundle.js"></script>
{% endblock %}
