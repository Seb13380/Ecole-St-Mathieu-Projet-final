<header class="w-full bg-[#a7e3dd]">
	<nav class="navbar w-full px-9 font-poppins">

		<div class="flex-none" style="margin-top: 2rem; margin-bottom: 1rem; margin-right: 0.5rem; margin-left: 0.5rem;">
			<a href="/" class="flex items-center gap-6">
				<img src="/assets/images/LogoStMathieuV.png" alt="Logo Ã‰cole" class="w-auto object-contain rounded-xl shadow-md" style="height: 120px; animation: bounce 3s infinite; transform-origin: center bottom;"/>
				<span class="text-xl font-bold text-[#304a4d]"></span>
			</a>
		</div>
		<div class="flex-none" style="margin-top: 2rem; margin-bottom: 1rem; margin-right: 0.5rem; margin-left: 0.5rem;">
			<a href="https://www.enseignementcatho-marseille.fr//" target="_blank" rel="noopener" class="flex items-center gap-6">
				<img src="/assets/images/logo_diocese.png" alt="Logo DiocÃ¨se" class="w-auto object-contain rounded-xl shadow-md" style="height: 120px; animation: bounce 3s infinite; transform-origin: center bottom;"/>
				<span class="text-xl font-bold text-[#304a4d]"></span>
			</a>
		</div>

		<div class="flex-1 flex justify-center">
			<ul class="menu menu-horizontal px-1 font-poppins-medium" style="font-size: 29px !important; font-weight: 600;">
				<li>
					<a href="/" class="hover:font-poppins-semibold transition-all" style="font-size: 29px !important;">Accueil</a>
				</li>
				<li>
					<a href="/gestion-ecole" class="hover:font-poppins-semibold transition-all" style="font-size: 29px !important;">OGEC</a>
				</li>
				<li class="dropdown dropdown-hover">
					<div tabindex="0" role="button" class="hover:font-poppins-semibold transition-all font-poppins-semibold" style="font-size: 29px !important;">
						Ecole
						<svg class="fill-current ml-1 w-4 h-4" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 20 20">
							<path d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.23 8.29a.75.75 0 01.02-1.06z"/>
						</svg>
					</div>
					<ul tabindex="0" class="dropdown-content menu bg-[#a7e3dd] rounded-box z-[1] w-64 p-2 shadow font-poppins-regular text-xl" style="margin-top:-0.1rem;">
						<li>
							<a href="/projet-educatif" class="hover:font-poppins-medium transition-all hover:bg-[#8dd3cc]">Projet Ã©ducatif</a>
						</li>
						<li>
							<a href="/projet-etablissement" class="hover:font-poppins-medium transition-all hover:bg-[#8dd3cc]">Projet d'Ã©tablissement</a>
						</li>
						<li>
							<a href="/reglement-interieur" class="hover:font-poppins-medium transition-all hover:bg-[#8dd3cc]">RÃ¨glement intÃ©rieur</a>
						</li>
						<li>
							<a href="/organigramme" class="hover:font-poppins-medium transition-all hover:bg-[#8dd3cc]">Organigramme</a>
						</li>
						<li class="relative">
							<div class="hover:font-poppins-medium transition-all flex items-center justify-between w-full cursor-pointer chartes-menu" onmouseover="showChartesMenu()" onmouseout="hideChartesMenu()" onclick="toggleChartesMenu()">
								Chartes
								<svg class="fill-current ml-1 w-3 h-3" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 20 20">
									<path d="M7.21 14.77a.75.75 0 01.02-1.06L10.94 10 7.23 6.29a.75.75 0 111.06-1.06l4.24 4.24a.75.75 0 010 1.06l-4.24 4.24a.75.75 0 01-1.08-.02z"/>
								</svg>
							</div>
							<div id="chartes-submenu" class="absolute left-full top-0 hidden z-[60] w-80 bg-[#a7e3dd] rounded-box shadow-lg p-2" onmouseover="showChartesMenu()" onmouseout="hideChartesMenu()" style="margin-left: 8px; min-width: 300px;">
								{% if isAuthenticated %}
									<ul class="menu font-poppins-regular text-sm">
										<li>
											<a href="/documents/charte-laicite.docx" target="_blank" class="hover:font-poppins-medium transition-all hover:bg-[#8dd3cc]">
												ðŸ“„ Charte de la laÃ¯citÃ©
											</a>
										</li>
										<li>
											<a href="/documents/charte-numerique.docx" target="_blank" class="hover:font-poppins-medium transition-all hover:bg-[#8dd3cc]">
												ðŸ“„ Charte du numÃ©rique
											</a>
										</li>
										<li>
											<a href="/documents/charte-vie-scolaire.docx" target="_blank" class="hover:font-poppins-medium transition-all hover:bg-[#8dd3cc]">
												ðŸ“„ Charte de vie scolaire
											</a>
										</li>
										<li>
											<a href="/documents/charte-restauration.docx" target="_blank" class="hover:font-poppins-medium transition-all hover:bg-[#8dd3cc]">
												ðŸ“„ Charte de restauration
											</a>
										</li>
									</ul>
								{% else %}
									<div class="text-gray-700 italic px-4 py-3 text-center bg-opacity-90 rounded-md">
										ðŸ”’ Connexion requise pour accÃ©der aux chartes
									</div>
								{% endif %}
							</div>
						</li>
						<li>
							<a href="/agenda" class="hover:font-poppins-medium transition-all">Agenda</a>
						</li>
						<li>
							<a href="/gallery" class="hover:font-poppins-medium transition-all">Images et VidÃ©os</a>
						</li>
					</ul>
				</li>

				<li class="dropdown dropdown-hover">
					<div tabindex="0" role="button" class="hover:font-poppins-semibold transition-all font-poppins-semibold" style="font-size: 29px !important;">
						Pastorale
						<svg class="fill-current ml-1 w-4 h-4" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 20 20">
							<path d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.23 8.29a.75.75 0 01.02-1.06z"/>
						</svg>
					</div>
					<ul tabindex="0" class="dropdown-content menu bg-[#a7e3dd] rounded-box z-[1] w-64 p-2 shadow font-poppins-regular text-xl" style="margin-top:-0.1rem;">
						<li>
							<a href="/projet-etablissement" class="hover:font-poppins-medium transition-all hover:bg-[#8dd3cc]">Axe Pastoral de l'Ã©cole</a>
						</li>

						<li>
							<a href="/reglement-interieur" class="hover:font-poppins-medium transition-all hover:bg-[#8dd3cc]">Fiche d'inscription au temps priant de l'Ã©cole</a>
						</li>
						<li>
							<a href="/projet-educatif" class="hover:font-poppins-medium transition-all hover:bg-[#8dd3cc]">Ensemble pastoral de l'Ã©toile</a>
						</li>
					</ul>
				</li>
				<li class="dropdown dropdown-hover">
					<div tabindex="0" role="button" class="hover:font-poppins-semibold transition-all font-poppins-semibold" style="font-size: 29px !important;">
						Restauration
						<svg class="fill-current ml-1 w-4 h-4" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 20 20">
							<path d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.23 8.29a.75.75 0 01.02-1.06z"/>
						</svg>
					</div>
					<ul tabindex="0" class="dropdown-content menu bg-[#a7e3dd] rounded-box z-[1] w-64 p-2 shadow font-poppins-regular text-xl" style="margin-top:-0.1rem;">
						<li>
							<a href="https://www.dupont-restauration.fr/" target="_blank" class="hover:font-poppins-medium transition-all hover:bg-[#8dd3cc]">Dupont Restauration</a>
						</li>
						<li>
							<a href="/restauration/menus" class="hover:font-poppins-medium transition-all hover:bg-[#8dd3cc]">Le chef vous propose</a>
						</li>
					</ul>
				</li>

				<li>
					<a href="" class="hover:font-poppins-semibold transition-all" style="font-size: 29px !important;">APEL</a>
				</li>

				<li>
					<a href="/auth/register" class="hover:font-poppins-semibold transition-all" style="font-size: 29px !important;">Inscription</a>
				</li>
			</ul>
			<div class="flex-none" style="margin-left: 3rem;">
				<a href="https://app.educartable.com/accounts-portal/" target="_blank" rel="noopener" class="flex items-center gap-6">
					<img src="/assets/images/educartable2.png" alt="Logo Educartable" class="w-auto object-contain rounded-xl shadow-md hover:scale-105 transition-all duration-300" style="height: 120px; animation: pulse-glow 4s ease-in-out infinite;"/>
					<span class="text-xl font-bold text-[#304a4d]"></span>
				</a>
			</div>
		</div>
		<div class="flex-none gap-4">
			{% if isAuthenticated %}
				<div class="dropdown dropdown-end">
					<div tabindex="0" role="button" class="btn btn-ghost font-poppins-medium">
						ðŸ‘¤
						{{ user.firstName }}
					</div>
					<ul tabindex="0" class="dropdown-content menu bg-[#a7e3dd] rounded-box z-[1] w-52 p-2 shadow font-poppins-regular">
						{% if user.role == 'ADMIN' %}
							<li>
								<a href="/admin/dashboard">Tableau de bord</a>
							</li>
						{% elseif user.role == 'DIRECTION' %}
							<li>
								<a href="/directeur/dashboard">Tableau de bord</a>
							</li>
						{% elseif user.role == 'GESTIONNAIRE_SITE' %}
							<li>
								<a href="/directeur/dashboard">Tableau de bord</a>
							</li>
						{% elseif user.role == 'ENSEIGNANT' %}
							<li>
								<a href="/enseignant/dashboard">Tableau de bord</a>
							</li>
						{% elseif user.role == 'PARENT' %}
							<li>
								<a href="/parent/dashboard">Tableau de bord</a>
							</li>
						{% else %}
							<li>
								<a href="/dashboard">Tableau de bord</a>
							</li>
						{% endif %}
						<li>
							<a href="/profile">Mon profil</a>
						</li>

						<li>
							<form action="/auth/logout" method="POST" class="w-full">
								<button type="submit" class="w-full text-left">DÃ©connexion</button>
							</form>
						</li>
					</ul>
				</div>
			{% else %}
				<a href="/auth/login" class="headerbutton Btn">Connexion</a>

			{% endif %}
		</div>
	</nav>
</header>

<style>
	/* AmÃ©lioration du positionnement du sous-menu des chartes */
	#chartes-submenu {
		/* S'assurer que le sous-menu est bien positionnÃ© Ã  droite */
		left: 100% !important;
		top: 0 !important;
		margin-left: 12px !important;
		/* Largeur adaptative selon le contenu */
		min-width: 300px !important;
		width: auto !important;
		/* Garder le background visible */
		background-color: #a7e3dd !important;
		/* Assurer une bonne visibilitÃ© */
		box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06) !important;
		border: 1px solid rgba(141, 211, 204, 0.3) !important;
		/* Permettre le retour Ã  la ligne pour le texte long */
		white-space: normal !important;
	}

	/* S'assurer que le parent a une position relative */
	.chartes-menu {
		position: relative !important;
	}

	/* Styles spÃ©cifiques pour le message non connectÃ© */
	#chartes-submenu .text-gray-700 {
		background-color: transparent !important;
		color: #374151 !important;
		padding: 12px 16px !important;
		border-radius: 6px !important;
		text-align: center !important;
		white-space: normal !important;
		line-height: 1.5 !important;
	}

	/* Styles pour les liens des chartes (utilisateur connectÃ©) */
	#chartes-submenu .menu li a {
		padding: 8px 12px !important;
		display: block !important;
		border-radius: 6px !important;
		transition: all 0.2s ease-in-out !important;
		white-space: normal !important;
		line-height: 1.4 !important;
	}

	#chartes-submenu .menu li a:hover {
		background-color: #8dd3cc !important;
		transform: translateX(2px) !important;
	}

	/* AmÃ©liorer la transition d'affichage */
	#chartes-submenu.hidden {
		opacity: 0;
		pointer-events: none;
		transform: translateX(-10px);
		transition: all 0.2s ease-in-out;
	}

	#chartes-submenu:not(.hidden) {
		opacity: 1;
		pointer-events: auto;
		transform: translateX(0);
		transition: all 0.2s ease-in-out;
	}

	/* Responsive - sur mobile, affichage vertical */
	@media(max-width: 768px) {
		#chartes-submenu {
			left: 0 !important;
			top: 100% !important;
			margin-left: 0 !important;
			margin-top: 4px !important;
			width: 100% !important;
			min-width: unset !important;
		}
	}
</style>

<script>
	let chartesMenuTimeout;

function showChartesMenu() {
clearTimeout(chartesMenuTimeout);
const submenu = document.getElementById('chartes-submenu');
if (submenu) {
submenu.classList.remove('hidden');
// S'assurer que le sous-menu est bien positionnÃ©
setTimeout(() => {
const rect = submenu.getBoundingClientRect();
const windowWidth = window.innerWidth;

// Si le sous-menu dÃ©passe la fenÃªtre, l'ajuster
if (rect.right > windowWidth) {
submenu.style.left = 'auto';
submenu.style.right = '100%';
submenu.style.marginLeft = '0';
submenu.style.marginRight = '12px';
}
}, 10);
}
}

function hideChartesMenu() {
chartesMenuTimeout = setTimeout(() => {
const submenu = document.getElementById('chartes-submenu');
if (submenu) {
submenu.classList.add('hidden');
// RÃ©initialiser la position
submenu.style.left = '';
submenu.style.right = '';
submenu.style.marginRight = '';
}
}, 300); // DÃ©lai de 300ms pour permettre le passage de la souris
}

function toggleChartesMenu() {
const submenu = document.getElementById('chartes-submenu');
if (submenu) {
if (submenu.classList.contains('hidden')) {
showChartesMenu();
} else {
hideChartesMenu();
}
}
}
</script>
